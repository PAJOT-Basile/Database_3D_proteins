scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", number_rows, "sequences in", order))
plot_grid(pl1, pl2, labels = c("A", "B"), ncol = 2, nrow = 1)
Number_of_sequences_per_family <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
number_rows <- nrow(Number_of_sequences_per_family)
pl1 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = Number_of_sequences)) +
geom_col(aes(color = Number_of_sequences)) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", number_rows, "sequences in", order))
Number_of_sequences_per_family <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
number_rows <- nrow(Number_of_sequences_per_family)
pl2 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = Number_of_sequences)) +
geom_col(aes(color = Number_of_sequences)) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", number_rows, "sequences in", order))
plot_grid(pl1, pl2, labels = c("A", "B"), ncol = 2, nrow = 1)
pl1 <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences))) %>%
ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = Number_of_sequences)) +
geom_col(aes(color = Number_of_sequences)) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(.), "sequences in", order))
pl1 <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences))) %>%
ggplot(aes(x = Family_name, y = Number_of_sequences)) +
geom_col(aes(color = Number_of_sequences)) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(.), "sequences in", order))
library(dplyr)
library(ggplot2)
library(stringr)
library(forcats)
library(gridExtra)
library(cowplot)
Number_of_families_per_kingdom <- read.csv("Number_of_families_per_superkingdom.csv", sep = ";", header = TRUE) %>%
as.data.frame()
ggplot(data = Number_of_families_per_kingdom, aes(x = Super_kingdom, y = Number_of_families)) +
geom_col(aes(fill = Super_kingdom)) +
geom_text(aes(x = Super_kingdom, y = Number_of_families, label = Number_of_families), vjust = 1) +
ggtitle("Number of families per Super-Kingdom") +
theme(legend.position = "none")
ggsave("Number of families per Super-Kingdom.png")
ggplot(data = Number_of_families_per_kingdom, aes(x = Super_kingdom, y = log(Number_of_sequences))) +
geom_col(aes(fill = Super_kingdom)) +
geom_text(aes(x = Super_kingdom, y = log(Number_of_sequences), label = Number_of_sequences), vjust = 1) +
ggtitle("Number of sequences per Super-Kingdom") +
theme(legend.position = "none")
ggsave("Number of sequences per Super-Kingdom.png")
Number_of_sequences_per_family_list_files <- list.files(path = "./", pattern = "_number_of_sequences_per_family.csv")
for (file in Number_of_sequences_per_family_list_files){
order <- str_split_fixed(file, "_", 6)[1]
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences))) %>%
pl1 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = Number_of_sequences)) +
geom_col(aes(color = Number_of_sequences)) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "sequences in", order))
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
pl2 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = Number_of_sequences)) +
geom_col(aes(color = Number_of_sequences)) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "sequences in", order))
plot_grid(pl1, pl2, labels = c("A", "B"), ncol = 2, nrow = 1)
ggsave(paste0("Number of sequences per family for ", order, ".png"))
}
for (file in Number_of_sequences_per_family_list_files){
}
for (file in Number_of_sequences_per_family_list_files){
order <- str_split_fixed(file, "_", 6)[1]
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences))
pl1 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = Number_of_sequences)) +
for (file in Number_of_sequences_per_family_list_files){
order <- str_split_fixed(file, "_", 6)[1]
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
pl1 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = Number_of_sequences)) +
geom_col(aes(color = Number_of_sequences)) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "sequences in", order))
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
pl2 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = Number_of_sequences)) +
geom_col(aes(color = Number_of_sequences)) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "sequences in", order))
plot_grid(pl1, pl2, labels = c("A", "B"), ncol = 2, nrow = 1)
ggsave(paste0("Number of sequences per family for ", order, ".png"))
}
?plot_grid
for (file in Number_of_sequences_per_family_list_files){
order <- str_split_fixed(file, "_", 6)[1]
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
pl1 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "sequences in", order))
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
pl2 <- ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order))
plot_grid(pl1, pl2, labels = c("A", "B"), ncol = 2, nrow = 1)
ggsave(paste0("Number of sequences per family for ", order, ".png"))
}
?merge
Number_of_sequences_per_family <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
Nb <- merge(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered, by = Family_name)
Nb <- merge(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered, by = "Family_name")
Nb <- merge(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered, by = "Family_name", all.x = TRUE)
names(Nb)
Number_of_sequences_per_family <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
Number_of_sequences_filtered = Number_of_sequences)
Nb <- merge(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered, by = "Family_name", all.x = TRUE)
names(Nb)
Number_of_sequences_per_family <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)))
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences))) %>%
rename(Number_of_sequences_filtered = Number_of_sequences)
Nb <- merge(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered, by = "Family_name", all.x = TRUE)
names(Nb)
Number_of_sequences_per_family <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Raw data")
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data")
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered)
ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID)
?facet_wrap
ggplot(Number_of_sequences_per_family, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(ID = desc(ID))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(ID = sort(ID))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(ID = arrange(ID))
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
arrange(ID)
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
arrange(-ID)
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
arrange(desc(ID))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered)
Nb$ID <- factor(Nb$ID, levels = c("Raw data", "Filtered data"))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data")))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) #%>%
#mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data (more than 100 sequences)")))
Nb$ID <- factor(Nb$ID, levels = c("Raw data", "Filtered data (more than 100 sequences)"))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~ID, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data (more than 100 sequences)")))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data (>100 sequences)")
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data (>100 sequences)")))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data")
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data")))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Nb$id
levels(Nb$id)
Number_of_sequences_per_family <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Raw data")
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data")
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data")))
ggplot(Nb, aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Nb <- rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Nb <-rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Number_of_sequences_per_family <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Raw data")
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", Number_of_sequences_per_family_list_files[1]), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data")
Nb <-rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(Nb$ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Nb <-rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
Nb
rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste("Number of sequences per family for", nrow(Number_of_sequences_per_family), "families in", order)) +
facet_wrap(~id, ncol = 2)
order <- str_split_fixed(file, "_", 6)[1]
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Raw data")
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data")
rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste0("Number of sequences per family for ",
nrow(Number_of_sequences_per_family),
" original families in ",
order,
" (",
nrow(Number_of_sequences_per_family_filtered),
" after filtering families with more than 100 sequences)")) +
facet_wrap(~id, ncol = 2)
rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "green") +
ggtitle(paste0("Number of sequences per family for ",
nrow(Number_of_sequences_per_family),
" original families in ",
order,
"\n(",
nrow(Number_of_sequences_per_family_filtered),
" after filtering families with more than 100 sequences)")) +
facet_wrap(~id, ncol = 2)
Number_of_families_per_kingdom <- read.csv("Number_of_families_per_superkingdom.csv", sep = ";", header = TRUE) %>%
as.data.frame()
p1 <-ggplot(data = Number_of_families_per_kingdom, aes(x = Super_kingdom, y = Number_of_families)) +
geom_col(aes(fill = Super_kingdom)) +
geom_text(aes(x = Super_kingdom, y = Number_of_families, label = Number_of_families), vjust = 1) +
ggtitle("Number of families per Super-Kingdom") +
theme(legend.position = "none")
p2 <- ggplot(data = Number_of_families_per_kingdom, aes(x = Super_kingdom, y = log(Number_of_sequences))) +
geom_col(aes(fill = Super_kingdom)) +
geom_text(aes(x = Super_kingdom, y = log(Number_of_sequences), label = Number_of_sequences), vjust = 1) +
ggtitle("Number of sequences per Super-Kingdom") +
theme(legend.position = "none")
plot_grid(p1, p2, ncol = 2, nrow = 1, labels = c("A", "B"))
library(dplyr)
library(ggplot2)
library(stringr)
library(forcats)
library(cowplot)
Number_of_families_per_kingdom <- read.csv("Number_of_families_per_superkingdom.csv", sep = ";", header = TRUE) %>%
as.data.frame()
p1 <-ggplot(data = Number_of_families_per_kingdom, aes(x = Super_kingdom, y = Number_of_families)) +
geom_col(aes(fill = Super_kingdom)) +
geom_text(aes(x = Super_kingdom, y = Number_of_families, label = Number_of_families), vjust = 1) +
ggtitle("Number of families per Super-Kingdom") +
theme(legend.position = "none")
p2 <- ggplot(data = Number_of_families_per_kingdom, aes(x = Super_kingdom, y = log(Number_of_sequences))) +
geom_col(aes(fill = Super_kingdom)) +
geom_text(aes(x = Super_kingdom, y = log(Number_of_sequences), label = Number_of_sequences), vjust = 1) +
ggtitle("Number of sequences per Super-Kingdom") +
theme(legend.position = "none")
plot_grid(p1, p2, ncol = 2, nrow = 1, labels = c("A", "B"))
ggsave("Stats per Super-Kingdom.png")
Number_of_sequences_per_family_list_files <- list.files(path = "./", pattern = "_number_of_sequences_per_family.csv")
for (file in Number_of_sequences_per_family_list_files){
order <- str_split_fixed(file, "_", 6)[1]
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Raw data")
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data")
rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "red") +
ggtitle(paste0("Number of sequences per family for ", nrow(Number_of_sequences_per_family), " original families in ", order,
"\n(", nrow(Number_of_sequences_per_family_filtered), " after filtering families with more than 100 sequences)"),
subtitle = paste0("(", ((Number_of_sequences_per_family_filtered/Number_of_sequences_per_family)*100), " families conserved)")) +
facet_wrap(~id, ncol = 2)
ggsave(paste0("Number of sequences per family for ", order, ".png"))
}
for (file in Number_of_sequences_per_family_list_files){
order <- str_split_fixed(file, "_", 6)[1]
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Raw data")
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data")
rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "red") +
ggtitle(paste0("Number of sequences per family for ", nrow(Number_of_sequences_per_family), " original families in ", order,
"\n(", nrow(Number_of_sequences_per_family_filtered), " after filtering families with more than 100 sequences)"),
subtitle = paste0("(", ( (nrow(Number_of_sequences_per_family_filtered) / nrow(Number_of_sequences_per_family) )*100),
" families conserved)")) +
facet_wrap(~id, ncol = 2)
ggsave(paste0("Number of sequences per family for ", order, ".png"))
}
for (file in Number_of_sequences_per_family_list_files){
order <- str_split_fixed(file, "_", 6)[1]
Number_of_sequences_per_family <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Raw data")
Number_of_sequences_per_family_filtered <- read.csv(paste0("./", file), sep = ";", header = TRUE) %>%
as.data.frame() %>%
filter(Number_of_sequences > 100) %>%
mutate(Family_name = fct_reorder(Family_name, desc(Number_of_sequences)),
ID = "Filtered data")
rbind(Number_of_sequences_per_family, Number_of_sequences_per_family_filtered) %>%
mutate(id = factor(ID, levels = c("Raw data", "Filtered data"))) %>%
ggplot(aes(x = Family_name, y = log(Number_of_sequences))) +
geom_col(aes(color = log(Number_of_sequences))) +
scale_color_gradient(low = "blue", high = "red") +
ggtitle(paste0("Number of sequences per family for ", nrow(Number_of_sequences_per_family), " original families in ", order,
"\n(", nrow(Number_of_sequences_per_family_filtered), " after filtering families with more than 100 sequences)"),
subtitle = paste0("(", round( (nrow(Number_of_sequences_per_family_filtered) / nrow(Number_of_sequences_per_family) )*100, digits = 1),
"% families conserved)")) +
facet_wrap(~id, ncol = 2)
ggsave(paste0("Number of sequences per family for ", order, ".png"))
}
library(readr)
Archaea_number_of_sequences_per_family <- read_csv("Archaea_number_of_sequences_per_family.csv")
View(Archaea_number_of_sequences_per_family)
library(readr)
Archaea_number_of_sequences_per_family <- read_csv("Archaea_number_of_sequences_per_family.csv", sep=";")
library(readr)
Archaea_number_of_sequences_per_family <- read_csv("Archaea_number_of_sequences_per_family.csv", delim=";")
?read_csv
library(readr)
Archaea_number_of_sequences_per_family <- read_delim("Archaea_number_of_sequences_per_family.csv", delim=";")
View(Archaea_number_of_sequences_per_family)
summary(Archaea_number_of_sequences_per_family)
Archaea_number_of_sequences_per_family$` Number_of_sequences` <- as.numeric(Archaea_number_of_sequences_per_family$` Number_of_sequences`)
summary(Archaea_number_of_sequences_per_family)
library(readr)
Archaea_number_of_sequences_per_family <- read_delim("Archaea_number_of_sequences_per_family.csv",
delim = ";", escape_double = FALSE, col_types = cols(Number_of_sequences = col_number()),
trim_ws = TRUE)
View(Archaea_number_of_sequences_per_family)
library(readr)
Bacteria_number_of_sequences_per_family <- read_delim("Bacteria_number_of_sequences_per_family.csv",
delim = ";", escape_double = FALSE, col_types = cols(Number_of_sequences = col_number()),
trim_ws = TRUE)
View(Bacteria_number_of_sequences_per_family)
library(readr)
Eukaryota_number_of_sequences_per_family <- read_delim("Eukaryota_number_of_sequences_per_family.csv",
delim = ";", escape_double = FALSE, col_types = cols(Number_of_sequences = col_number()),
trim_ws = TRUE)
View(Eukaryota_number_of_sequences_per_family)
summary(Archaea_number_of_sequences_per_family)
summary(Bacteria_number_of_sequences_per_family)
summary(Eukaryota_number_of_sequences_per_family)
